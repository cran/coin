<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>coin: LinearStatistic.c Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.4.2 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="dirs.html">Directories</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a></div>
<h1>LinearStatistic.c</h1><a href="LinearStatistic_8c.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment">00001 
00009 <span class="preprocessor">#include "<a class="code" href="CI__common_8h.html">CI_common.h</a>"</span>
00010 
<a name="l00022"></a><a class="code" href="LinearStatistic_8c.html#a0">00022</a> <span class="keywordtype">void</span> <a class="code" href="LinearStatistic_8c.html#a0">C_kronecker</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> *A, <span class="keyword">const</span> <span class="keywordtype">int</span> m, <span class="keyword">const</span> <span class="keywordtype">int</span> n,
00023                   <span class="keyword">const</span> <span class="keywordtype">double</span> *B, <span class="keyword">const</span> <span class="keywordtype">int</span> r, <span class="keyword">const</span> <span class="keywordtype">int</span> s,
00024                   <span class="keywordtype">double</span> *ans) {
00025 
00026     <span class="keywordtype">int</span> i, j, k, l, mr, js, ir;
00027     <span class="keywordtype">double</span> y;
00028 
00029     mr = m * r;
00030     <span class="keywordflow">for</span> (i = 0; i &lt; m; i++) {
00031         ir = i * r;
00032         <span class="keywordflow">for</span> (j = 0; j &lt; n; j++) {
00033             js = j * s;
00034             y = A[j*m + i];
00035             <span class="keywordflow">for</span> (k = 0; k &lt; r; k++) {
00036                 <span class="keywordflow">for</span> (l = 0; l &lt; s; l++) {
00037                     ans[(js + l) * mr + ir + k] = y * B[l * r + k];
00038                 }
00039             }
00040         }
00041     }
00042 }  
00043 
00044 
<a name="l00051"></a><a class="code" href="LinearStatistic_8c.html#a1">00051</a> SEXP <a class="code" href="LinearStatistic_8c.html#a1">R_kronecker</a>(SEXP A, SEXP B) {
00052 
00053     <span class="keywordtype">int</span> m, n, r, s;
00054     SEXP ans;
00055 
00056     <span class="keywordflow">if</span> (!isReal(A) || !isReal(B))
00057         error(<span class="stringliteral">"R_kronecker: A and / or B are not of type REALSXP"</span>);
00058 
00059     m = <a class="code" href="CIstuff_8c.html#a0">nrow</a>(A);
00060     n = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(A);
00061     r = <a class="code" href="CIstuff_8c.html#a0">nrow</a>(B);
00062     s = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(B);
00063     
00064     PROTECT(ans = allocVector(REALSXP, m * n * r * s));
00065     <a class="code" href="LinearStatistic_8c.html#a0">C_kronecker</a>(REAL(A), m, n, REAL(B), r, s, REAL(ans));
00066     UNPROTECT(1);
00067     <span class="keywordflow">return</span>(ans);
00068 }
00069 
00070 
<a name="l00080"></a><a class="code" href="LinearStatistic_8c.html#a2">00080</a> <span class="keywordtype">void</span> <a class="code" href="LinearStatistic_8c.html#a2">C_ExpectCovarInfluence</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* y, <span class="keyword">const</span> <span class="keywordtype">int</span> q,
00081                             <span class="keyword">const</span> <span class="keywordtype">double</span>* weights, <span class="keyword">const</span> <span class="keywordtype">int</span> n, 
00082                             SEXP ans) {
00083 
00084     <span class="keywordtype">int</span> i, j, k, jq;
00085     
00086     <span class="comment">/* pointers to the slots of object ans */</span>
00087     <span class="keywordtype">double</span> *dExp_y, *dCov_y, *dsweights, tmp;
00088     
00089     <span class="comment">/*  return values: set to zero initially */</span>
00090     dExp_y = REAL(GET_SLOT(ans, <a class="code" href="Classes_8c.html#a0">CI_expectationSym</a>));
00091     <span class="keywordflow">for</span> (j = 0; j &lt; q; j++) dExp_y[j] = 0.0;
00092     
00093     dCov_y = REAL(GET_SLOT(ans, <a class="code" href="Classes_8c.html#a1">CI_covarianceSym</a>));
00094     <span class="keywordflow">for</span> (j = 0; j &lt; q*q; j++) dCov_y[j] = 0.0;
00095     
00096     dsweights = REAL(GET_SLOT(ans, <a class="code" href="Classes_8c.html#a2">CI_sumweightsSym</a>));
00097 
00098     <span class="comment">/*  compute the sum of the weights */</span>
00099         
00100     dsweights[0] = 0;
00101     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) dsweights[0] += weights[i];
00102     <span class="keywordflow">if</span> (dsweights[0] &lt;= 1) 
00103         error(<span class="stringliteral">"C_ExpectCovarInfluence: sum of weights is less than one"</span>);
00104 
00105     <span class="comment">/*</span>
00106 <span class="comment">     *    Expectation of the influence function</span>
00107 <span class="comment">     */</span>
00108 
00109     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
00110 
00111         <span class="comment">/*  observations with zero case weights do not contribute */</span>
00112     
00113         <span class="keywordflow">if</span> (weights[i] == 0.0) <span class="keywordflow">continue</span>;
00114     
00115         <span class="keywordflow">for</span> (j = 0; j &lt; q; j++)
00116             dExp_y[j] += weights[i] * y[j * n + i];
00117     }
00118 
00119     <span class="keywordflow">for</span> (j = 0; j &lt; q; j++)
00120         dExp_y[j] = dExp_y[j] / dsweights[0];
00121 
00122 
00123     <span class="comment">/*</span>
00124 <span class="comment">     *    Covariance of the influence function</span>
00125 <span class="comment">     */</span>
00126 
00127     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
00128 
00129         <span class="keywordflow">if</span> (weights[i] == 0.0) <span class="keywordflow">continue</span>;
00130      
00131         <span class="keywordflow">for</span> (j = 0; j &lt; q; j++) {
00132             tmp = weights[i] * (y[j * n + i] - dExp_y[j]);
00133             jq = j * q;
00134             <span class="keywordflow">for</span> (k = 0; k &lt; q; k++)
00135                 dCov_y[jq + k] += tmp * (y[k * n + i] - dExp_y[k]);
00136         }
00137     }
00138 
00139     <span class="keywordflow">for</span> (j = 0; j &lt; q*q; j++)
00140         dCov_y[j] = dCov_y[j] / dsweights[0];
00141 }
00142 
00143 
<a name="l00150"></a><a class="code" href="LinearStatistic_8c.html#a3">00150</a> SEXP <a class="code" href="LinearStatistic_8c.html#a3">R_ExpectCovarInfluence</a>(SEXP y, SEXP weights) {
00151 
00152     SEXP ans;
00153     <span class="keywordtype">int</span> q, n;
00154     
00155     <span class="keywordflow">if</span> (!isReal(y) || !isReal(weights))
00156         error(<span class="stringliteral">"R_ExpectCovarInfluence: arguments are not of type REALSXP"</span>);
00157     
00158     n = <a class="code" href="CIstuff_8c.html#a0">nrow</a>(y);
00159     q = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(y);
00160     
00161     <span class="keywordflow">if</span> (LENGTH(weights) != n) 
00162         error(<span class="stringliteral">"R_ExpectCovarInfluence: vector of case weights does not have %d elements"</span>, n);
00163 
00164     <span class="comment">/*  allocate storage for return values */</span>
00165     PROTECT(ans = NEW_OBJECT(MAKE_CLASS(<span class="stringliteral">"ExpectCovarInfluence"</span>)));
00166     SET_SLOT(ans, <a class="code" href="Classes_8c.html#a0">CI_expectationSym</a>, 
00167              PROTECT(allocVector(REALSXP, q)));
00168     SET_SLOT(ans, <a class="code" href="Classes_8c.html#a1">CI_covarianceSym</a>, 
00169              PROTECT(allocMatrix(REALSXP, q, q)));
00170     SET_SLOT(ans, <a class="code" href="Classes_8c.html#a2">CI_sumweightsSym</a>, 
00171              PROTECT(allocVector(REALSXP, 1)));
00172 
00173     <a class="code" href="LinearStatistic_8c.html#a2">C_ExpectCovarInfluence</a>(REAL(y), q, REAL(weights), n, ans);
00174     
00175     UNPROTECT(4);
00176     <span class="keywordflow">return</span>(ans);
00177 }
00178 
00179 
<a name="l00192"></a><a class="code" href="LinearStatistic_8c.html#a4">00192</a> <span class="keywordtype">void</span> <a class="code" href="LinearStatistic_8c.html#a4">C_ExpectCovarLinearStatistic</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>* x, <span class="keyword">const</span> <span class="keywordtype">int</span> p, 
00193                                   <span class="keyword">const</span> <span class="keywordtype">double</span>* y, <span class="keyword">const</span> <span class="keywordtype">int</span> q,
00194                                   <span class="keyword">const</span> <span class="keywordtype">double</span>* weights, <span class="keyword">const</span> <span class="keywordtype">int</span> n,
00195                                   <span class="keyword">const</span> SEXP expcovinf, SEXP ans) {
00196 
00197     <span class="keywordtype">int</span> i, j, k, pq, ip;
00198     <span class="keywordtype">double</span> sweights = 0.0, f1, f2, tmp;
00199     <span class="keywordtype">double</span> *swx, *CT1, *CT2, *Covy_x_swx, 
00200            *dExp_y, *dCov_y, *dExp_T, *dCov_T;
00201     
00202     pq   = p * q;
00203     
00204     <span class="comment">/* the expectation and covariance of the influence function */</span>
00205     dExp_y = REAL(GET_SLOT(expcovinf, <a class="code" href="Classes_8c.html#a0">CI_expectationSym</a>));
00206     dCov_y = REAL(GET_SLOT(expcovinf, <a class="code" href="Classes_8c.html#a1">CI_covarianceSym</a>));
00207     sweights = REAL(GET_SLOT(expcovinf, <a class="code" href="Classes_8c.html#a2">CI_sumweightsSym</a>))[0];
00208 
00209     <span class="keywordflow">if</span> (sweights &lt;= 1.0) 
00210         error(<span class="stringliteral">"C_ExpectCovarLinearStatistic: sum of weights is less than one"</span>);
00211 
00212     <span class="comment">/* prepare for storing the results */</span>
00213     dExp_T = REAL(GET_SLOT(ans, <a class="code" href="Classes_8c.html#a0">CI_expectationSym</a>));
00214     dCov_T = REAL(GET_SLOT(ans, <a class="code" href="Classes_8c.html#a1">CI_covarianceSym</a>));
00215 
00216     <span class="comment">/* allocate storage: all helpers, initially zero */</span>
00217     swx = Calloc(p, <span class="keywordtype">double</span>);               <span class="comment">/* p x 1  */</span>
00218     CT1 = Calloc(p * p, <span class="keywordtype">double</span>);           <span class="comment">/* p x p  */</span>
00219 
00220     <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
00221 
00222         <span class="comment">/*  observations with zero case weights do not contribute */</span>
00223         <span class="keywordflow">if</span> (weights[i] == 0.0) <span class="keywordflow">continue</span>;
00224     
00225         ip = i*p;
00226         <span class="keywordflow">for</span> (k = 0; k &lt; p; k++) {
00227             tmp = weights[i] * x[k * n + i];
00228             swx[k] += tmp;
00229 
00230             <span class="comment">/* covariance part */</span>
00231             <span class="keywordflow">for</span> (j = 0; j &lt; p; j++) {
00232                 CT1[j * p + k] += tmp * x[j * n + i];
00233             }
00234         }
00235     }
00236 
00237     <span class="comment">/*</span>
00238 <span class="comment">    *   dExp_T: expectation of the linear statistic T</span>
00239 <span class="comment">    */</span>
00240 
00241     <span class="keywordflow">for</span> (k = 0; k &lt; p; k++) {
00242         <span class="keywordflow">for</span> (j = 0; j &lt; q; j++)
00243             dExp_T[j * p + k] = swx[k] * dExp_y[j];
00244     }
00245 
00246     <span class="comment">/* </span>
00247 <span class="comment">    *   dCov_T:  covariance of the linear statistic T</span>
00248 <span class="comment">    */</span>
00249 
00250     f1 = sweights/(sweights - 1);
00251     f2 = (1/(sweights - 1));
00252 
00253     <span class="keywordflow">if</span> (pq == 1) {
00254         dCov_T[0] = f1 * dCov_y[0] * CT1[0];
00255         dCov_T[0] -= f2 * dCov_y[0] * swx[0] * swx[0];
00256     } <span class="keywordflow">else</span> {
00257         <span class="comment">/* two more helpers needed */</span>
00258         CT2 = Calloc(pq * pq, <span class="keywordtype">double</span>);            <span class="comment">/* pq x pq */</span>
00259         Covy_x_swx = Calloc(pq * q, <span class="keywordtype">double</span>);      <span class="comment">/* pq x q  */</span>
00260         
00261         <a class="code" href="LinearStatistic_8c.html#a0">C_kronecker</a>(dCov_y, q, q, CT1, p, p, dCov_T);
00262         <a class="code" href="LinearStatistic_8c.html#a0">C_kronecker</a>(dCov_y, q, q, swx, p, 1, Covy_x_swx);
00263         <a class="code" href="LinearStatistic_8c.html#a0">C_kronecker</a>(Covy_x_swx, pq, q, swx, 1, p, CT2);
00264 
00265         <span class="keywordflow">for</span> (k = 0; k &lt; (pq * pq); k++)
00266             dCov_T[k] = f1 * dCov_T[k] - f2 * CT2[k];
00267 
00268         <span class="comment">/* clean up */</span>
00269         Free(CT2); Free(Covy_x_swx);
00270     }
00271 
00272     <span class="comment">/* clean up */</span>
00273     Free(swx); Free(CT1); 
00274 }
00275 
00276 
<a name="l00285"></a><a class="code" href="LinearStatistic_8c.html#a5">00285</a> SEXP <a class="code" href="LinearStatistic_8c.html#a5">R_ExpectCovarLinearStatistic</a>(SEXP x, SEXP y, SEXP weights, 
00286                                   SEXP expcovinf) {
00287     
00288     SEXP ans;
00289     <span class="keywordtype">int</span> n, p, q, pq;
00290 
00291     <span class="comment">/* determine the dimensions and some checks */</span>
00292 
00293     n  = <a class="code" href="CIstuff_8c.html#a0">nrow</a>(x);
00294     p  = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(x);
00295     q  = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(y);
00296     pq = p * q;
00297     
00298     <span class="keywordflow">if</span> (<a class="code" href="CIstuff_8c.html#a0">nrow</a>(y) != n)
00299         error(<span class="stringliteral">"y does not have %d rows"</span>, n);
00300     <span class="keywordflow">if</span> (LENGTH(weights) != n) 
00301         error(<span class="stringliteral">"vector of case weights does not have %d elements"</span>, n);
00302 
00303     PROTECT(ans = NEW_OBJECT(MAKE_CLASS(<span class="stringliteral">"ExpectCovar"</span>)));
00304     SET_SLOT(ans, <a class="code" href="Classes_8c.html#a0">CI_expectationSym</a>, 
00305              PROTECT(allocVector(REALSXP, pq)));
00306     SET_SLOT(ans, <a class="code" href="Classes_8c.html#a1">CI_covarianceSym</a>, 
00307              PROTECT(allocMatrix(REALSXP, pq, pq)));
00308 
00309     <a class="code" href="LinearStatistic_8c.html#a4">C_ExpectCovarLinearStatistic</a>(REAL(x), p, REAL(y), q, 
00310         REAL(weights), n, expcovinf, ans);
00311     
00312     UNPROTECT(3);
00313     <span class="keywordflow">return</span>(ans);
00314 }
00315 
<a name="l00327"></a><a class="code" href="LinearStatistic_8c.html#a6">00327</a> <span class="keywordtype">void</span> <a class="code" href="LinearStatistic_8c.html#a6">C_LinearStatistic</a> (<span class="keyword">const</span> <span class="keywordtype">double</span> *x, <span class="keyword">const</span> <span class="keywordtype">int</span> p,
00328                         <span class="keyword">const</span> <span class="keywordtype">double</span> *y, <span class="keyword">const</span> <span class="keywordtype">int</span> q,
00329                         <span class="keyword">const</span> <span class="keywordtype">double</span> *weights, <span class="keyword">const</span> <span class="keywordtype">int</span> n,
00330                         <span class="keywordtype">double</span> *ans) {
00331               
00332     <span class="keywordtype">int</span> i, j, k, kp, kn, ip;
00333     <span class="keywordtype">double</span> tmp;
00334 
00335     <span class="keywordflow">for</span> (k = 0; k &lt; q; k++) {
00336 
00337         kn = k * n;
00338         kp = k * p;
00339         <span class="keywordflow">for</span> (j = 0; j &lt; p; j++) ans[kp + j] = 0.0;
00340             
00341         <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {
00342                 
00343             <span class="comment">/* optimization: weights are often zero */</span>
00344             <span class="keywordflow">if</span> (weights[i] == 0.0) <span class="keywordflow">continue</span>;
00345                 
00346             tmp = y[kn + i] * weights[i];
00347                 
00348             ip = i * p;
00349             <span class="keywordflow">for</span> (j = 0; j &lt; p; j++)
00350                  ans[kp + j] += x[j*n + i] * tmp;
00351         }
00352     }
00353 }
00354 
00355 
<a name="l00363"></a><a class="code" href="LinearStatistic_8c.html#a7">00363</a> SEXP <a class="code" href="LinearStatistic_8c.html#a7">R_LinearStatistic</a>(SEXP x, SEXP y, SEXP weights) {
00364 
00365     <span class="comment">/* the return value; a vector of type REALSXP */</span>
00366     SEXP ans;
00367 
00368     <span class="comment">/* dimensions */</span>
00369     <span class="keywordtype">int</span> n, p, q;
00370 
00371     <span class="comment">/* </span>
00372 <span class="comment">     *    only a basic check: we do not coerce objects since this</span>
00373 <span class="comment">     *    function is for internal use only</span>
00374 <span class="comment">     */</span>
00375     
00376     <span class="keywordflow">if</span> (!isReal(x) || !isReal(y) || !isReal(weights))
00377         error(<span class="stringliteral">"LinStat: arguments are not of type REALSXP"</span>);
00378     
00379     n = <a class="code" href="CIstuff_8c.html#a0">nrow</a>(y);
00380     <span class="keywordflow">if</span> (<a class="code" href="CIstuff_8c.html#a0">nrow</a>(x) != n || LENGTH(weights) != n)
00381         error(<span class="stringliteral">"LinStat: dimensions don't match"</span>);
00382 
00383     q    = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(y);
00384     p    = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(x);
00385            
00386     PROTECT(ans = allocVector(REALSXP, p*q));
00387  
00388     <a class="code" href="LinearStatistic_8c.html#a6">C_LinearStatistic</a>(REAL(x), p, REAL(y), q, REAL(weights), n, 
00389                       REAL(ans));
00390 
00391     UNPROTECT(1);
00392     <span class="keywordflow">return</span>(ans);
00393 }
00394 
00395 
<a name="l00409"></a><a class="code" href="LinearStatistic_8h.html#a0">00409</a> <span class="keywordtype">void</span> <a class="code" href="LinearStatistic_8c.html#a8">C_PermutedLinearStatistic</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *x, <span class="keyword">const</span> <span class="keywordtype">int</span> p,
00410                                <span class="keyword">const</span> <span class="keywordtype">double</span> *y, <span class="keyword">const</span> <span class="keywordtype">int</span> q,
00411                                <span class="keyword">const</span> <span class="keywordtype">int</span> n, <span class="keyword">const</span> <span class="keywordtype">int</span> nperm,
00412                                <span class="keyword">const</span> <span class="keywordtype">int</span> *indx, <span class="keyword">const</span> <span class="keywordtype">int</span> *perm, 
00413                                <span class="keywordtype">double</span> *ans) {
00414 
00415     <span class="keywordtype">int</span> i, j, k, kp, kn, knpi;
00416 
00417     <span class="keywordflow">for</span> (k = 0; k &lt; q; k++) {
00418 
00419         kn = k * n;
00420         kp = k * p;
00421         <span class="keywordflow">for</span> (j = 0; j &lt; p; j++) ans[kp + j] = 0.0;
00422             
00423         <span class="keywordflow">for</span> (i = 0; i &lt; nperm; i++) {
00424                 
00425             knpi = kn + perm[i];
00426 
00427             <span class="keywordflow">for</span> (j = 0; j &lt; p; j++)
00428                 ans[kp + j] += x[j*n + indx[i]] * y[knpi];
00429         }
00430     }
00431 }
00432 
00433 
<a name="l00442"></a><a class="code" href="LinearStatistic_8c.html#a9">00442</a> SEXP <a class="code" href="LinearStatistic_8c.html#a9">R_PermutedLinearStatistic</a>(SEXP x, SEXP y, SEXP indx, SEXP perm) {
00443 
00444     SEXP ans;
00445     <span class="keywordtype">int</span> n, nperm, p, q, i, *iperm, *iindx;
00446 
00447     <span class="comment">/* </span>
00448 <span class="comment">       only a basic check</span>
00449 <span class="comment">    */</span>
00450 
00451     <span class="keywordflow">if</span> (!isReal(x) || !isReal(y))
00452         error(<span class="stringliteral">"R_PermutedLinearStatistic: arguments are not of type REALSXP"</span>);
00453     
00454     <span class="keywordflow">if</span> (!isInteger(perm))
00455         error(<span class="stringliteral">"R_PermutedLinearStatistic: perm is not of type INTSXP"</span>);
00456     <span class="keywordflow">if</span> (!isInteger(indx))
00457         error(<span class="stringliteral">"R_PermutedLinearStatistic: indx is not of type INTSXP"</span>);
00458     
00459     n = <a class="code" href="CIstuff_8c.html#a0">nrow</a>(y);
00460     nperm = LENGTH(perm);
00461     iperm = INTEGER(perm);
00462     <span class="keywordflow">if</span> (LENGTH(indx)  != nperm)
00463         error(<span class="stringliteral">"R_PermutedLinearStatistic: dimensions don't match"</span>);
00464     iindx = INTEGER(indx);
00465 
00466     <span class="keywordflow">if</span> (<a class="code" href="CIstuff_8c.html#a0">nrow</a>(x) != n)
00467         error(<span class="stringliteral">"R_PermutedLinearStatistic: dimensions don't match"</span>);
00468 
00469     <span class="keywordflow">for</span> (i = 0; i &lt; nperm; i++) {
00470         <span class="keywordflow">if</span> (iperm[i] &lt; 0 || iperm[i] &gt; (n - 1) )
00471             error(<span class="stringliteral">"R_PermutedLinearStatistic: perm is not between 1 and nobs"</span>);
00472         <span class="keywordflow">if</span> (iindx[i] &lt; 0 || iindx[i] &gt; (n - 1) )
00473             error(<span class="stringliteral">"R_PermutedLinearStatistic: indx is not between 1 and nobs"</span>);
00474     }
00475 
00476     q    = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(y);
00477     p    = <a class="code" href="CIstuff_8c.html#a1">ncol</a>(x);
00478            
00479     PROTECT(ans = allocVector(REALSXP, p*q));
00480     
00481     <a class="code" href="LinearStatistic_8c.html#a8">C_PermutedLinearStatistic</a>(REAL(x), p, REAL(y), q, n, nperm,
00482                  iindx, iperm, REAL(ans));
00483     
00484     UNPROTECT(1);
00485     <span class="keywordflow">return</span>(ans);
00486 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Wed Apr 12 09:05:27 2006 for coin by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.4.2 </small></address>
</body>
</html>
